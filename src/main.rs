// Purpose: just say $search <word> and the terminal displays the meaning of the word.
// Problem: the html i'm getting in let html = ... is completely diff from the html im seeing when i hit inspect.
// Bigger problem: Scraping google is against its policies, according to gpt. I might get banned bruh

use clap::Parser;
use reqwest::Client;
use scraper::{Html, Selector};

#[derive(Parser)]
struct CLI {
    input: String,
}

#[tokio::main]
async fn main() -> Result<(), Box<dyn std::error::Error>>{
    let args = CLI::parse();
    println!("provided args: {}", args.input);

    let client = Client::new();
    println!("created new client object!");

    let query = args.input.replace(" ", "+");
    println!("query: {}", query);

    let url = format!("https://www.google.com/search?q={}+meaning", query);
    println!("generated url: {url}");

    println!("awaiting client");
    let res = client.get(&url).send().await.unwrap();
    println!("received word from client!");
    // println!("res: {:#?}", res);

    let html = res.text().await.expect("IDK WHAT THE FUCK");
    println!("extracted html");
    println!("html: {:#?}", html);

    let fragment = Html::parse_document(&html);
    println!("parsed html");
    let selector = Selector::parse("div.WaaZC").unwrap();
    println!("selected the div with class WaaZC");

    for element in fragment.select(&selector) {
        println!("in the loop");
        println!("element: {:?}", element);
        let meaning_selector = Selector::parse("span.oXzekf").unwrap();
        println!("meaning_selector: {:?}", meaning_selector);
        let meaning_element = element.select(&meaning_selector).next().unwrap();
        println!("meaning_element: {:?}", meaning_element);
        let meaning = meaning_element.text().collect::<Vec<_>>().join("");

        println!("{}", meaning);
    }

    Ok(())
}

// <span class="oXzekf">Travesty is a noun that means <mark class="QVRyCf">something is shocking, upsetting, or ridiculous because it is not what it is supposed to be, but is instead a distorted or badly inferior imitation of it</mark>. </span>
// <div class="WaaZC Zh8Myb"><div class="rPeykc PZPZlf" data-attrid="SGEParagraphFeedback" data-hveid="CCAQAA" data-ved="2ahUKEwiqhYuUn_6FAxWfa_UHHZzIDjsQo_EKegQIIBAA"><span class="oXzekf">Travesty is a noun that means <mark class="QVRyCf">something is shocking, upsetting, or ridiculous because it is not what it is supposed to be, but is instead a distorted or badly inferior imitation of it</mark>. </span><span class="oXzekf">For example, "Their trial was a travesty of justice".<span class="UV3uM">&nbsp;<div data-cid="_N4k7ZuqNHZ_X1e8PnJG72AM_43" class="NPrrbc"><div jsname="HtgYJd" class="BMebGe VQSoxc btku5b k0Jjg fCrZyc LwdV0e FR7ZSc OJeuxf PrjL8c" jsaction="click:trigger.km1vMe;rcuQ6b:trigger.E98K4" aria-label="Collapse" role="button" tabindex="0" data-hveid="CCEQAA" data-ved="2ahUKEwiqhYuUn_6FAxWfa_UHHZzIDjsQ3fYKegQIIRAA"><div class="niO4u VDgVie SlP8xc iCQO5d"><div class="kHtcsd DopHqc"><span class="d3o3Ad Hkv2Pe"><span class="kK1PHd gNGSDf"><span style="height:18px;line-height:18px;width:18px" class="z1asCe bjaP2b"><svg focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"></path></svg></span></span></span></div></div></div></div></span> </span><div id="_N4k7ZuqNHZ_X1e8PnJG72AM_43" class="zl1RWe gfHI2e" style="margin-top:20px;margin-bottom:20px;display:block" jsname="haAclf" data-ved="2ahUKEwiqhYuUn_6FAxWfa_UHHZzIDjsQ1NMLegQIIRAC"><div class="I6Kpxd XNfAUb z1Mm0e" jscontroller="s0j7C" id="_N4k7ZuqNHZ_X1e8PnJG72AM_51" jsdata="M2v9If;_;Au5dYo" jsshadow="" jsaction="wbfeDd:EDKYjb;c2Q7He:aJ8u7;F9ekxb:nnsrCf;WGwvzc:Xj7hvb;sOvSJd:OR1BUb;a7JlDe:HFYvKc;keydown:uYT2Vb;rcuQ6b:npT2md;lnkFzb:jCOVSe"><div jsname="haAclf" class="RyIFgf" data-scca="" data-hveid="CCEQAw" data-ved="2ahUKEwiqhYuUn_6FAxWfa_UHHZzIDjsQ_sgKegQIIRAD" style="overflow-x: auto;"><div jsname="s2gQvd" class="EDblX HG5ZQb" role="list" jsslot=""><div class="aDFspc fO4k7 XRVJtc x3A3gd CLLuUd KAt2X" jscontroller="QQ51Ce" jsshadow="" role="listitem" jsaction="rcuQ6b:npT2md" data-hveid="CCEQBA" data-ved="2ahUKEwiqhYuUn_6FAxWfa_UHHZzIDjsQlcIJKAB6BAghEAQ"><div class="VqeGe" jsslot="" style="width:236px"> <div class="p7bv ar9V1 DfMusf y6CIle">    <div class="dsxN8b EXH1Ce PZPZlf" data-attrid="SGEAttributionFeedback" data-fburl="https://www.dictionary.com/browse/travesty#:~:text=Phonetic%20(Standard)%20IPA-,noun,grotesque%20imitation%20of%20its%20model." data-hveid="CCEQBg" data-ved="2ahUKEwiqhYuUn_6FAxWfa_UHHZzIDjsQ_8gKegQIIRAG">      <a class="ddkIM rz5jw c30Ztd" href="https://www.dictionary.com/browse/travesty#:~:text=Phonetic%20(Standard)%20IPA-,noun,grotesque%20imitation%20of%20its%20model." tabindex="0" aria-label="TRAVESTY Definition &amp; Meaning - Dictionary.com" ping="/url?sa=t&amp;source=web&amp;rct=j&amp;opi=89978449&amp;url=https://www.dictionary.com/browse/travesty%23:~:text%3DPhonetic%2520(Standard)%2520IPA-,noun,grotesque%2520imitation%2520of%2520its%2520model.&amp;ved=2ahUKEwiqhYuUn_6FAxWfa_UHHZzIDjsQudELegQIIRAH">  <span jscontroller="IX53Tb" jsaction="rcuQ6b:npT2md" style="display:none"></span> </a>  <div class="IqywMd">  <div class="ODrFK CwjDuc">  <div class="DH9lqb pieH8c"> <div class="wep10b vDF3Oc jIrdcd"><div class="iDBaYb"><div class="d6R6kf"><div><div class="oRVWZ GB3ilc Vwoesf" aria-hidden="true"><img class="XNo5Ab lWlVCe" id="tsuid_64" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAALVBMVEUAJIsAI4sAAIAAE4f////b4O93hbnt8PiqstPCyeFhcK8AAHbK0uY2SpssRJqkzl1wAAAAAXRSTlP2FDiPTwAAAFVJREFUeAFjYBQEAwEGQShgEBRSUlIyBDFUXFxck8CMiikunopgkdUtLslgRlCLyyEYowjGCIIxmmEMQyijFsQQbglapQgyUFCv2RhkFxAbgiyFOwMAxO4Yfa2wgogAAAAASUVORK5CYII=" style="height:16px;width:16px" alt="" data-deferred="3" data-csiid="1" data-atf="1"></div></div></div><div class="LbKnXb YAG2qc UYJxh"><div class="R8BTeb q8U8x du278d">Dictionary.com</div></div></div></div> <div class="Ux0Ks y9pG6d"><div jscontroller="gOTY1" data-id="atritem-https://www.dictionary.com/browse/travesty" jsdata="PFrTzf;_;Au5dYs" data-viewer-group="1" jsaction="rcuQ6b:npT2md;aevozb:T2P31d;vcOT6c:C6KsF;k7WJpc:beCLof"><div><div jsdata="l7Bhpb;_;Au5dY4" jscontroller="PbHo4e" jsshadow="" jsaction="rcuQ6b:npT2md;h5M12e;jGQF0b:kNqZ1c;" data-viewer-entrypoint="1" data-ved="2ahUKEwiqhYuUn_6FAxWfa_UHHZzIDjsQ2esEegQIIRAK"><div jsslot=""><div jsname="I3kE2c" class="mzNRm iTPLzd rNSxBe eY4mx lUn2nc" aria-label="About this result" role="button" tabindex="0"><span jsname="czHhOd" class="D6lY4c mBswFe"><span jsname="Bil8Ae" class="xTFaxe z1asCe" style="height:16px;line-height:16px;width:16px"><svg focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"></path></svg></span></span></div></div></div></div></div></div> </div> <div class="VaiWld CvgGZ AZxNrb yVCOtc aKoISd" style="color:inherit"><span class="Yt787" style="-webkit-line-clamp:2">TRAVESTY Definition &amp; Meaning - Dictionary.com</span></div> <div class="VaiWld cQEt3 dMCttd" style="font-family:inherit;-webkit-line-clamp:2">   noun. , plural trav·es·ties. a grotesque or debased likeness or imitation: a travesty of justice. Synonyms: distortion, sham, perversion, mockery. a literary or artistic burlesque of a serious work or subject, characterized by grotesque or ludicrous incongruity of style, treatment, or subject matter. a literary or artistic composition so inferior in quality as to be merely a grotesque imitation of its model. </div>  </div> </div> </div>  </div> </div></div><div class="aDFspc fO4k7 XRVJtc x3A3gd CLLuUd KAt2X" jscontroller="QQ51Ce" jsshadow="" role="listitem" jsaction="rcuQ6b:npT2md" data-hveid="CCEQCw" data-ved="2ahUKEwiqhYuUn_6FAxWfa_UHHZzIDjsQlcIJKAF6BAghEAs"><div class="VqeGe" jsslot="" style="width:236px"> <div class="p7bv ar9V1 DfMusf y6CIle">    <div class="dsxN8b EXH1Ce PZPZlf" data-attrid="SGEAttributionFeedback" data-fburl="https://www.merriam-webster.com/word-of-the-day/travesty-2023-08-13#:~:text=Travesty%20refers%20to%20something%20that,instead%20to%20a%20disastrous%20event." data-hveid="CCEQDQ" data-ved="2ahUKEwiqhYuUn_6FAxWfa_UHHZzIDjsQ_8gKegQIIRAN">      <a class="ddkIM rz5jw c30Ztd" href="https://www.merriam-webster.com/word-of-the-day/travesty-2023-08-13#:~:text=Travesty%20refers%20to%20something%20that,instead%20to%20a%20disastrous%20event." tabindex="0" aria-label="Word of the Day: Travesty | Merriam-Webster" ping="/url?sa=t&amp;source=web&amp;rct=j&amp;opi=89978449&amp;url=https://www.merriam-webster.com/word-of-the-day/travesty-2023-08-13%23:~:text%3DTravesty%2520refers%2520to%2520something%2520that,instead%2520to%2520a%2520disastrous%2520event.&amp;ved=2ahUKEwiqhYuUn_6FAxWfa_UHHZzIDjsQudELegQIIRAO">  <span jscontroller="IX53Tb" jsaction="rcuQ6b:npT2md" style="display:none"></span> </a>  <div class="IqywMd">  <div class="ODrFK CwjDuc">  <div class="DH9lqb pieH8c"> <div class="wep10b vDF3Oc jIrdcd"><div class="iDBaYb"><div class="d6R6kf"><div><div class="oRVWZ GB3ilc Vwoesf" aria-hidden="true"><img class="XNo5Ab lWlVCe" id="tsuid_70" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAY1BMVEX////trq/ibG/jdHftq6343t7eUFT10NH21tbfV1v32trgYmb32drfW199lbrj6O9kgq/5+vzO1+STpcTJ0uGmts+4xdjK3Ovkd3qInr9cfqx0kLeywNXlgIOesMv3///Z3+rHaxW9AAAAdUlEQVR4AW1OgwHAMBC82lac7L9k7fbtP/yTZTuO7Z6p5weLC6N4z5Oj46Sr86/VbN0PcC0vd2zkBcqqbtquH8iyiI62DOCCdpBrQTSKFm3T7QVb88KUBsbUBcjfUURXIdnKzpHLcPNxlm6IQxzkOlISF780AYyRBTGVnUskAAAAAElFTkSuQmCC" style="height:16px;width:16px" alt="" data-deferred="3" data-csiid="2" data-atf="1"></div></div></div><div class="LbKnXb YAG2qc UYJxh"><div class="R8BTeb q8U8x du278d">merriam-webster.com</div></div></div></div> <div class="Ux0Ks y9pG6d"><div jscontroller="gOTY1" data-id="atritem-https://www.merriam-webster.com/word-of-the-day/travesty-2023-08-13" jsdata="PFrTzf;_;Au5dYs" data-viewer-group="1" jsaction="rcuQ6b:npT2md;aevozb:T2P31d;vcOT6c:C6KsF;k7WJpc:beCLof"><div><div jsdata="l7Bhpb;_;Au5dYw" jscontroller="PbHo4e" jsshadow="" jsaction="rcuQ6b:npT2md;h5M12e;jGQF0b:kNqZ1c;" data-viewer-entrypoint="1" data-ved="2ahUKEwiqhYuUn_6FAxWfa_UHHZzIDjsQ2esEegQIIRAR"><div jsslot=""><div jsname="I3kE2c" class="mzNRm iTPLzd rNSxBe eY4mx lUn2nc" aria-label="About this result" role="button" tabindex="0"><span jsname="czHhOd" class="D6lY4c mBswFe"><span jsname="Bil8Ae" class="xTFaxe z1asCe" style="height:16px;line-height:16px;width:16px"><svg focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"></path></svg></span></span></div></div></div></div></div></div> </div> <div class="VaiWld CvgGZ AZxNrb yVCOtc aKoISd" style="color:inherit"><span class="Yt787" style="-webkit-line-clamp:2">Word of the Day: Travesty | Merriam-Webster</span></div> <div class="VaiWld cQEt3 dMCttd" style="font-family:inherit;-webkit-line-clamp:2">  <span>  13 Aug 2023  —  </span> Travesty refers to something that is shocking, upsetting, or ridiculous because it is not what it is supposed to be, but is instead a distorted or badly inferior imitation of it. The word is often used in the phrase “a travesty of.” Travesty is not a synonym of tragedy, which refers instead to a disastrous event. </div>  </div> </div> </div>  </div> </div></div><div class="aDFspc fO4k7 XRVJtc x3A3gd CLLuUd KAt2X" jscontroller="QQ51Ce" jsshadow="" role="listitem" jsaction="rcuQ6b:npT2md" data-hveid="CCEQEg" data-ved="2ahUKEwiqhYuUn_6FAxWfa_UHHZzIDjsQlcIJKAJ6BAghEBI"><div class="VqeGe" jsslot="" style="width:236px"> <div class="p7bv ar9V1 DfMusf y6CIle">    <div class="dsxN8b EXH1Ce PZPZlf" data-attrid="SGEAttributionFeedback" data-fburl="https://www.collinsdictionary.com/sentences/english/travesty#:~:text=It%20would%20have%20been%20a,was%20a%20travesty%20of%20justice.&amp;text=That%20would%20be%20a%20travesty,of%20anything%20remotely%20resembling%20justice." data-hveid="CCEQFA" data-ved="2ahUKEwiqhYuUn_6FAxWfa_UHHZzIDjsQ_8gKegQIIRAU">      <a class="ddkIM rz5jw c30Ztd" href="https://www.collinsdictionary.com/sentences/english/travesty#:~:text=It%20would%20have%20been%20a,was%20a%20travesty%20of%20justice.&amp;text=That%20would%20be%20a%20travesty,of%20anything%20remotely%20resembling%20justice." tabindex="0" aria-label="Examples of 'TRAVESTY' in a sentence - Collins Dictionary" ping="/url?sa=t&amp;source=web&amp;rct=j&amp;opi=89978449&amp;url=https://www.collinsdictionary.com/sentences/english/travesty%23:~:text%3DIt%2520would%2520have%2520been%2520a,was%2520a%2520travesty%2520of%2520justice.%26text%3DThat%2520would%2520be%2520a%2520travesty,of%2520anything%2520remotely%2520resembling%2520justice.&amp;ved=2ahUKEwiqhYuUn_6FAxWfa_UHHZzIDjsQudELegQIIRAV">  <span jscontroller="IX53Tb" jsaction="rcuQ6b:npT2md" style="display:none"></span> </a>  <div class="IqywMd">  <div class="ODrFK CwjDuc">  <div class="DH9lqb pieH8c"> <div class="wep10b vDF3Oc jIrdcd"><div class="iDBaYb"><div class="d6R6kf"><div><div class="oRVWZ GB3ilc Vwoesf" aria-hidden="true"><img class="XNo5Ab lWlVCe" id="tsuid_77" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAZlBMVEXGLyTGLiPFLCHFKyDGLSLJOi/RVk3WamLTX1bMRDrHNCraeXLxzMn89fT++/v////9+Pj34uDknpnnqaXy0M7il5HdhX777+7cf3jUY1v02Nb45+bNSkDZdG3KPDLxzcrgj4nvw8AQO3lPAAAAj0lEQVR4AU1OAxIFMQwtUmNt3/+QH9VsBtETioUJpQQQKivjQkhVdm2s81XdGJz2tq5t1/XVQMIBRj/NDNOln3EAqLUa4D8yHQBE+IkHbFRAdK4aFedy2HZ4HYh0/qAhTTxjZqt+p0BOsaccYqquY1ejTzkQOtbKb5urygH2+1lX23GM8oXo89T47YUwju8vXY0GyidVv38AAAAASUVORK5CYII=" style="height:16px;width:16px" alt="" data-deferred="3" data-csiid="3" data-atf="1"></div></div></div><div class="LbKnXb YAG2qc UYJxh"><div class="R8BTeb q8U8x du278d">collinsdictionary.com</div></div></div></div> <div class="Ux0Ks y9pG6d"><div jscontroller="gOTY1" data-id="atritem-https://www.collinsdictionary.com/sentences/english/travesty" jsdata="PFrTzf;_;Au5dYs" data-viewer-group="1" jsaction="rcuQ6b:npT2md;aevozb:T2P31d;vcOT6c:C6KsF;k7WJpc:beCLof"><div><div jsdata="l7Bhpb;_;Au5dZA" jscontroller="PbHo4e" jsshadow="" jsaction="rcuQ6b:npT2md;h5M12e;jGQF0b:kNqZ1c;" data-viewer-entrypoint="1" data-ved="2ahUKEwiqhYuUn_6FAxWfa_UHHZzIDjsQ2esEegQIIRAY"><div jsslot=""><div jsname="I3kE2c" class="mzNRm iTPLzd rNSxBe eY4mx lUn2nc" aria-label="About this result" role="button" tabindex="0"><span jsname="czHhOd" class="D6lY4c mBswFe"><span jsname="Bil8Ae" class="xTFaxe z1asCe" style="height:16px;line-height:16px;width:16px"><svg focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"></path></svg></span></span></div></div></div></div></div></div> </div> <div class="VaiWld CvgGZ AZxNrb yVCOtc aKoISd" style="color:inherit"><span class="Yt787" style="-webkit-line-clamp:2">Examples of 'TRAVESTY' in a sentence - Collins Dictionary</span></div> <div class="VaiWld cQEt3 dMCttd" style="font-family:inherit;-webkit-line-clamp:2">   It would have been a complete travesty if she had won. Their trial was a travesty of justice. That would be a travesty of justice. What a total travesty of anything remotely resembling justice. </div>  </div> </div> </div>  </div> </div></div></div></div><div jsname="Y5ANHe" class="EQOGhe"><g-left-button jsname="sIJmDf" class="wgbRNb bCwlI OZ5bRd zfpUke tHT0l pQXcHc" style="top: 0px; left: -18px;" aria-hidden="true" jsaction="PfjCMb" aria-label="Previous" role="button"><g-fab class="sr9hec OvQkSb s3IB3" style="background-color:#303134;color:#9aa0a6"><span class="U8v51e S3PB2d z1asCe"><svg focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"></path></svg></span></g-fab></g-left-button></div><div jsname="AK6yne" class="EQOGhe"><g-right-button jsname="IHFM4" style="top:0px;right:-18px" aria-hidden="true" jsaction="sYPGdb" class="wgbRNb VdehBf OZ5bRd zfpUke tHT0l" aria-label="Next" role="button"><g-fab class="sr9hec OvQkSb s3IB3" style="background-color:#303134;color:#9aa0a6"><span class="U8v51e S3PB2d z1asCe"><svg focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg></span></g-fab></g-right-button></div><script nonce="">(function(){
// (this||self).Bqpk9e=function(f,d,n,e,k,p){var g=document.getElementById(f);if(g&&(0!==g.offsetWidth||0!==g.offsetHeight)){var l=g.querySelector("div"),h=l.querySelector("div"),a=0;f=Math.max(l.scrollWidth-l.offsetWidth,0);if(0<d&&(h=h.children,a=h[d].offsetLeft-h[0].offsetLeft,e)){for(var m=a=0;m<d;++m)a+=h[m].offsetWidth;a=Math.min(f,a)}a+=n;d=Math.min(e?f-a:a,f);l.scrollLeft=e&&p?a:e&&k?-a:d;var b=g.getElementsByTagName("g-left-button")[0],c=g.getElementsByTagName("g-right-button")[0];b&&c&&(e=
// RegExp("\\btHT0l\\b"),k=RegExp("\\bpQXcHc\\b"),b.className=b.className.replace(e,""),c.className=c.className.replace(e,""),b.className=0===d?"pQXcHc "+b.className:b.className.replace(k,""),c.className=d===f?"pQXcHc "+c.className:c.className.replace(k,""),setTimeout(function(){b.className+=" tHT0l";c.className+=" tHT0l"},50))}};}).call(this);(function(){var id='_N4k7ZuqNHZ_X1e8PnJG72AM_51';var index=0;var offset=0;var is_rtl=false;var is_gecko=false;var is_edge=false;var init='Bqpk9e';window[init](id,index,offset,is_rtl,is_gecko,is_edge);})();</script></div></div></div></div>